var h="https://cloudflare-dns.com/dns-query",s=new doh.DohResolver(h),A=r=>setTimeout(r,0);function d(r){if(typeof r!="string"||r.length===0){let e=new Error("Invalid hostname");throw e.code="EINVAL",e}try{r.includes("://")&&(r=new URL(r).hostname)}catch{}return r}function O(r,e,t){typeof e=="function"&&(t=e,e={}),e=e||{};try{r=d(r)}catch(f){return A(()=>t(f))}let u=e.family||0,n=!!e.all,o=[];u===4?o.push(s.query(r,"A")):(u===6||o.push(s.query(r,"A")),o.push(s.query(r,"AAAA"))),Promise.allSettled(o).then(f=>{let l=[];if(f.forEach((i,N)=>{if(i.status!=="fulfilled")return;let w=u===4?"A":u===6?"AAAA":N===0?"A":"AAAA",q=(i.value.answers||[]).filter(c=>c.type===w).map(c=>({address:c.data,family:w==="A"?4:6}));l.push(...q)}),l.length===0){let i=new Error(`getaddrinfo ENOTFOUND ${r}`);return i.code="ENOTFOUND",A(()=>t(i))}if(n)return A(()=>t(null,l));let p=l[0];A(()=>t(null,p.address,p.family))}).catch(f=>A(()=>t(f)))}function y(r,e){try{r=d(r)}catch(t){return A(()=>e(t))}s.query(r,"A").then(t=>{let u=(t.answers||[]).filter(n=>n.type==="A").map(n=>n.data);if(u.length===0){let n=new Error(`queryA ENOTFOUND ${r}`);return n.code="ENOTFOUND",A(()=>e(n))}A(()=>e(null,u))}).catch(t=>A(()=>e(t)))}function E(r,e){try{r=d(r)}catch(t){return A(()=>e(t))}s.query(r,"AAAA").then(t=>{let u=(t.answers||[]).filter(n=>n.type==="AAAA").map(n=>n.data);if(u.length===0){let n=new Error(`queryAAAA ENOTFOUND ${r}`);return n.code="ENOTFOUND",A(()=>e(n))}A(()=>e(null,u))}).catch(t=>A(()=>e(t)))}var D=y,v={lookup(r,e={}){return new Promise((t,u)=>{O(r,e,(n,o,f)=>{if(n)return u(n);if(e.all)return t(o);t({address:o,family:f})})})},resolve4(r){return new Promise((e,t)=>{y(r,(u,n)=>u?t(u):e(n))})},resolve6(r){return new Promise((e,t)=>{E(r,(u,n)=>u?t(u):e(n))})}},F={lookup:O,resolve:D,resolve4:y,resolve6:E,promises:v};export{F as default,O as lookup,v as promises,D as resolve,y as resolve4,E as resolve6};
/*! For license information please see dns.js.LEGAL.txt */
