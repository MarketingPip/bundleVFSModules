var y=globalThis.setTimeout;globalThis.setTimeout=(c,n,...i)=>{let t=r,a=d(),l="Timeout",f={asyncId:a,type:l,triggerAsyncId:t};return b.set(a,f),s.forEach(o=>{o.enabled&&o.callbacks.init&&o.callbacks.init(a,l,t,f)}),y(async()=>{let o=r;r=a,s.forEach(e=>{e.enabled&&e.callbacks.before&&e.callbacks.before(a)});try{await c(...i)}finally{s.forEach(e=>{e.enabled&&e.callbacks.after&&e.callbacks.after(a)}),s.forEach(e=>{e.enabled&&e.callbacks.destroy&&e.callbacks.destroy(a)}),r=o,b.delete(a)}},n)};var k=1,b=new Map,r=0;function d(){return k++}var u=class{constructor(n){this.callbacks=n||{},this.enabled=!1}enable(){return this.enabled=!0,this}disable(){return this.enabled=!1,this}};function g(c){return new u(c)}function I(){return r}function w(){let c=b.get(r);return c?c.triggerAsyncId:0}function p(c,n="Function",i=r){let t=d(),a={asyncId:t,type:n,triggerAsyncId:i};return b.set(t,a),s.forEach(l=>{if(l.enabled&&l.callbacks.init)try{l.callbacks.init(t,n,i,a)}catch{}}),async function(...l){let f=r;r=t,s.forEach(e=>{if(e.enabled&&e.callbacks.before)try{e.callbacks.before(t)}catch{}});let o;try{o=await c(...l),s.forEach(e=>{if(e.enabled&&e.callbacks.promiseResolve)try{e.callbacks.promiseResolve(t)}catch{}})}catch(e){throw e}finally{s.forEach(e=>{if(e.enabled&&e.callbacks.after)try{e.callbacks.after(t)}catch{}}),s.forEach(e=>{if(e.enabled&&e.callbacks.destroy)try{e.callbacks.destroy(t)}catch{}}),b.delete(t),r=f}return o}}var s=[];function E(c){s.push(c)}function m(c,n="Promise",i=r){return p(c,n,i)()}export{g as createHook,I as executionAsyncId,E as registerHook,w as triggerAsyncId,p as wrapAsyncResource,m as wrapPromise};
/*! For license information please see async_hooks.js.LEGAL.txt */
